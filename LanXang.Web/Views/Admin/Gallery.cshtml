@{
    ViewBag.Title = "Gallery";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

@section header {
    <link href="@Url.Content("~/Content/styles/jquery.fileupload-ui.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Content/scripts/jquery.ui.widget.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/scripts/jquery.iframe-transport.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/scripts/jquery.fileupload.js")" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            //$('#fileupload').fileupload();

            $('#fileupload').fileupload({
                dataType: 'json',
                add: function (e, data) {
                    $(this).fileupload('process', data).done(function () {
                        data.submit();
                    });
                },
                done: function (e, data) {
                    $.each(data.result, function (index, file) {
                        $('<p/>').text(file.name).appendTo(document.body);
                    });
                }
            });

            $('#test').click(function () {
                $('#fileupload').fileupload('process');
            });
        });
    </script>
}

<input id="fileUpload" type="file" name="files[]" data-url="@Url.Action("UpdateFiles")" multiple />

<br />

<input id="test" type="button" value="Test" />
